game.Lighting.MainColorCorrection.TintColor = Color3.fromRGB(0, 0, 0)
wait(2)
game.Lighting.MainColorCorrection.TintColor = Color3.fromRGB(255, 255, 255)
game:GetService("Lighting").MainColorCorrection.Contrast = 10

function GitAud(soundgit,filename)
    SoundName=tostring(SoundName)
    local url=soundgit
    local FileName = filename
    writefile(FileName..".mp3", game:HttpGet(url))
    return (getcustomasset or getsynasset)(FileName..".mp3")
end

function CustomGitSound(soundlink, vol, filename)
    local sound = Instance.new("Sound")
    sound.SoundId = GitAud(soundlink, filename)
    sound.Parent = workspace
    sound.Volume = 2
    sound.PlaybackSpeed = 1
    sound.Name = "DREAMCORE"
    sound.Looped = false
   sound:Play()
end

CustomGitSound("https://github.com/Guestly-V2-2/Music-Sound/raw/refs/heads/main/YTDowncom_YouTube_Six-Forty-Seven_Media_NkzzjHaXfaw_001_1080p.mp3?raw=true", 1, " dreammusic")

local player = game.Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "overlaygui"
screenGui.Parent = playerGui
screenGui.IgnoreGuiInset = true

local red = Instance.new("ImageLabel")
red.Name = "overlay"
red.Size = UDim2.new(1, 0, 1, 0)
red.BackgroundTransparency = 1 -- Make the background fully transparent
red.Image = "rbxassetid://89921841313942" -- Set the image using a random Image ID
red.ImageTransparency = 0
red.ZIndex = 2
red.Parent = screenGui

local red2 = Instance.new("ImageLabel")
red2.Name = "overlay2"
red2.Size = UDim2.new(1, 0, 1, 0)
red2.BackgroundTransparency = 1 -- Make the background fully transparent
red2.ImageTransparency = 0.8
red2.Parent = screenGui
red2.ZIndex = 1

local img = red2

local images = {
	"rbxassetid://76637426417491",
	"rbxassetid://94547864377343"
}

local i = 1

while true do
	img.Image = images[i]
	i = i % #images + 1
	task.wait(0.5)
end

-- COLLISION (đoạn bị ngắt)
local Character = game.Players.LocalPlayer.Character or game.Players.LocalPlayer.CharacterAdded:Wait()
local Humanoid = Character:WaitForChild("Humanoid")
local RootPart = Character:WaitForChild("HumanoidRootPart")
local Camera = workspace.CurrentCamera
local Collision

Collision = Character:FindFirstChild("CollisionPart")
    if not Collision then
        for _, part in pairs(Character:GetChildren()) do
            if part:IsA("BasePart") and part.Name:lower():find("collision") then
                Collision = part
                break
            end
        end
    end
    
    if not Collision then
        Collision = RootPart
    end
    
    local CollisionClone = Collision:Clone()
    CollisionClone.CanCollide = false
    CollisionClone.Massless = true
    CollisionClone.CanQuery = false
    CollisionClone.Name = "CollisionClone"
    
    if CollisionClone:FindFirstChild("CollisionCrouch") then
        CollisionClone.CollisionCrouch:Destroy()
    end
    
    CollisionClone.Parent = Character
    
    task.spawn(function()
        while Character.Parent do
            if RootPart.Anchored then
                CollisionClone.Massless = true
                repeat task.wait() until not RootPart.Anchored
                task.wait(0.15)
            else
                CollisionClone.Massless = not CollisionClone.Massless
            end
            task.wait(0.24)
        end
    end)

local Players = game:GetService("Players")
local player = Players.LocalPlayer

local DESIRED_SPEED = 21

local function applyToCharacter(char)
	local hum = char:WaitForChild("Humanoid")

	-- set ngay lần đầu
	hum.WalkSpeed = DESIRED_SPEED

	-- theo dõi mọi thay đổi
	hum:GetPropertyChangedSignal("WalkSpeed"):Connect(function()
		if hum.WalkSpeed ~= DESIRED_SPEED then
			hum.WalkSpeed = DESIRED_SPEED
		end
	end)

	-- backup loop phòng trường hợp bị force đổi liên tục
	task.spawn(function()
		while hum.Parent do
			if hum.WalkSpeed ~= DESIRED_SPEED then
				hum.WalkSpeed = DESIRED_SPEED
			end
			task.wait(0)
		end
	end)
end

-- khi spawn
if player.Character then
	applyToCharacter(player.Character)
end

-- khi respawn
player.CharacterAdded:Connect(applyToCharacter)

-------------------------------------------------
-- SERVICES
-------------------------------------------------
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")

-------------------------------------------------
-- PLAYER
-------------------------------------------------
local LocalPlayer = Players.LocalPlayer
local character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local hrp = character:WaitForChild("HumanoidRootPart")
local Lighting = game:GetService("Lighting")

-------------------------------------------------
-- CONFIG
-------------------------------------------------
local PART_SPEED =  20         -- tá»‘c Ä‘á»™ di chuyá»ƒn
local SPAWN_DISTANCE = 170     -- spawn phÃ­a sau player

-------------------------------------------------
-- STATE
-------------------------------------------------
local isPlayerHiding = false
local triggered = false
local CHASE_DURATION = 60 -- 1 phút
local chaseStartTime = tick()
local chaseEnded = false

local function BlackoutEffect()
	-- lưu lighting cũ
	local oldBrightness = Lighting.Brightness
	local oldClockTime = Lighting.ClockTime
	local oldFogEnd = Lighting.FogEnd

	Lighting.Brightness = 0
	Lighting.ClockTime = 0
	Lighting.FogEnd = 5

	task.wait(2) -- thời gian bị đen màn

	-- trả lại bình thường
	Lighting.Brightness = oldBrightness
	Lighting.ClockTime = oldClockTime
	Lighting.FogEnd = oldFogEnd
end

-------------------------------------------------
-- PART (SPAWN SAU LÆ¯NG PLAYER)
-------------------------------------------------
local offsetX = math.random(-10,10)
local offsetY = math.random(-3,3)

local part = Instance.new("Part")
part.Size = Vector3.new(5,5,5)
part.Anchored = true
part.Transparency = 1
part.CanCollide = false
part.Massless = true
part.CastShadow = false
part.CFrame = hrp.CFrame * CFrame.new(offsetX, offsetY, SPAWN_DISTANCE)
part.Parent = workspace

-------------------------------------------------
-- BILLBOARD
-------------------------------------------------
local billboard = Instance.new("BillboardGui")
billboard.Size = UDim2.new(15,0,15,0)
billboard.AlwaysOnTop = true
billboard.StudsOffset = Vector3.new(0,0.3,0)
billboard.Adornee = part
billboard.Parent = part

local imageLabel = Instance.new("ImageLabel")
imageLabel.Size = UDim2.new(1,0,1,0)
imageLabel.BackgroundTransparency = 1
imageLabel.Parent = billboard

-------------------------------------------------
-- IMAGES
-------------------------------------------------
local IMAGE_ID_1 = "rbxassetid://109195590059206"
local IMAGE_ID_2 = "rbxassetid://100354158951933"
local IMAGE_IDLE = "rbxassetid://70679133939195" -- máº·t khi Ä‘á»©ng im
imageLabel.Image = IMAGE_ID_1

-------------------------------------------------
-- BILLBOARD IMAGE CONTROLLER
-------------------------------------------------
task.spawn(function()
	local toggle = false

	while part.Parent do
		if isPaused then
			-- Ä‘á»©ng im â†’ 1 máº·t duy nháº¥t
			imageLabel.Image = IMAGE_IDLE
			task.wait(0.1)
		else
			-- di chuyá»ƒn â†’ Ä‘á»•i máº·t liÃªn tá»¥c
			toggle = not toggle
			imageLabel.Image = toggle and IMAGE_ID_1 or IMAGE_ID_2
			task.wait(1)
		end
	end
end)

-------------------------------------------------
-- BILLBOARD SHAKE (FIX)
-------------------------------------------------
task.spawn(function()
	local t = 0
	while imageLabel.Parent do
		t += 0.15
		imageLabel.Position = UDim2.new(
			0, math.sin(t) * 3,
			0, math.cos(t * 1.3) * 3
		)
		imageLabel.Rotation = math.sin(t * 0.8) * 2
		task.wait(65)
	end
end)

-------------------------------------------------
-- HIDE DETECTOR (USING HIDING ATTRIBUTE)
-------------------------------------------------
task.spawn(function()
	while character.Parent do
		-- Æ°u tiÃªn láº¥y tá»« character
		local hiding = character:GetAttribute("Hiding")

		-- fallback: cÃ³ vÃ i báº£n gáº¯n attribute á»Ÿ HRP
		if hiding == nil then
			hiding = hrp:GetAttribute("Hiding")
		end

		isPlayerHiding = (hiding == true)
		task.wait(0.1)
	end
end)

-------------------------------------------------
-- DIRECT GHOST CHASE (XUYÊN TƯỜNG)
-------------------------------------------------
task.spawn(function()
	while part.Parent do
		
		-- ⏳ HẾT 1 PHÚT → KẾT THÚC
		if not chaseEnded and tick() - chaseStartTime >= CHASE_DURATION then
			chaseEnded = true
			task.spawn(BlackoutEffect)
			part:Destroy()
     local music = game.Workspace.DREAMCORE
if music then
game.Workspace.DREAMCORE:Destroy()
end
if not music then
print("no music found")
end

			break
		end
		
		isPaused = isPlayerHiding

		if not isPaused then
			local targetPos = hrp.Position
			local direction = (targetPos - part.Position)
			local distance = direction.Magnitude
			
			if distance > 1 then
				local moveVector = direction.Unit * PART_SPEED * 0.03
				part.CFrame = part.CFrame + moveVector
			end
		end
		
		task.wait(0.03) -- mượt
	end
end)

-------------------------------------------------
-- TOUCH HOOK + DESTROY
-------------------------------------------------
part.Touched:Connect(function(hit)
if chaseEnded then return end
	if triggered then return end
	local hum = hit.Parent and hit.Parent:FindFirstChildOfClass("Humanoid")
	if hum and hit.Parent == character then
		triggered = true

-- ================= DEATH HINT =================
firesignal(
    game.ReplicatedStorage.RemotesFolder.DeathHint.OnClientEvent,
    {
        "You died to who called Cataclysm..",
        "He will never stop chasing you even though he is slow.",
        "You did it good. Good luck."
    },
    "Blue"
)

game.ReplicatedStorage.GameStats["Player_" .. player.Name]
    .Total.DeathCause.Value = "Cataclysm"

local music = game.Workspace.DREAMCORE
if music then
game.Workspace.DREAMCORE:Destroy()
end
if not music then
print("no music found")
end

wait(1.5)
local achievementGiver = loadstring(game:HttpGet("https://raw.githubusercontent.com/Voor-Pr00/Achivements/refs/heads/main/Voorpr0"))()

---====== Display achievement ======---
achievementGiver({
    Title = "Monitoring",
    Desc = "I'm slow, you're weak.",
    Reason = "Died to Cataclysm.",
    Image = "rbxassetid://108102111650983"
})

		part:Destroy()
	end
end)
